!function(e){function t(){!function(e,t,n,a,o,r,c){e.fbq||(o=e.fbq=function(){o.callMethod?o.callMethod.apply(o,arguments):o.queue.push(arguments)},e._fbq||(e._fbq=o),o.push=o,o.loaded=!0,o.version="2.0",o.queue=[],r=t.createElement(n),r.async=!0,r.src=a,c=t.getElementsByTagName(n)[0],c.parentNode.insertBefore(r,c))}(e,document,"script","https://connect.facebook.net/en_US/fbevents.js");try{fbq("init",I.pixelId)}catch(t){}}function n(){!function(e,t,n,a,o,r,c){e[o]||(e.GlobalSnowplowNamespace=e.GlobalSnowplowNamespace||[],e.GlobalSnowplowNamespace.push(o),e[o]=function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].q=e[o].q||[],r=t.createElement(n),c=t.getElementsByTagName(n)[0],r.async=1,r.src=a,c.parentNode.insertBefore(r,c))}(e,document,"script","https://d2wa5sea6guof0.cloudfront.net/2.10.2.js","vantageSnowplow"),e.vantageSnowplow("newTracker","cf2","track2.vantageanalytics.com",{appId:"vantage",platform:"web",cookieName:"_spva_",respectDoNotTrack:!0,userFingerprint:!0}),e.vantageSnowplow("trackPageView")}function a(){function t(){dataLayer.push(arguments)}var n=document.getElementsByTagName("head")[0],a=document.createElement("script");a.type="text/javascript",a.src="https://www.googletagmanager.com/gtag/js?id="+I.googleConversionTrackerId,a.async=!0,n.appendChild(a),e.dataLayer=e.dataLayer||[],e.gtag=t,e.gtag("js",new Date),e.gtag("config",I.googleConversionTrackerId,{conversion_cookie_prefix:"vantage"})}function o(e){var t=e;return"string"==typeof e&&(t=e.replace(/[^\d.-]/g,"")),t}function r(e){var t=o(e);if(t)return parseFloat(t)}function c(e){var t=o(e);if(t)return parseInt(t)}function i(e){var t=[];localStorage["vantage-tracked-orders"]&&(t=JSON.parse(localStorage["vantage-tracked-orders"])),t.indexOf(e)===-1&&t.push(String(e)),localStorage["vantage-tracked-orders"]=JSON.stringify(t)}function d(e){var t=JSON.parse(localStorage["vantage-tracked-orders"]);return t.indexOf(String(e))>=0}function u(e){var t=[],n=/vantage_checkout_tokens=((\w+,?)*)/,a=n.exec(document.cookie);if(Array.isArray(a)&&"undefined"!=typeof a[1]&&(t=a[1].split(",")),t.indexOf(e)!=-1)return!1;t.push(e);var o=new Date,r=new Date(o);return r.setDate(o.getDate()+30),document.cookie="vantage_checkout_tokens="+t.join(",")+";path=/;expires="+r,!0}function s(e){var t=6e4,n=1,a=new Date(e),o=new Date;if(o<a)return!1;var r=(o-a)/t;return r<=n}function l(e){var t=[s(e.updated_at),u(e.token)].every(function(e){return e});return!!t}function g(t,n,a,o,d,u,s){var l=[],g=[];if(u&&u.length>0&&(l=u.map(function(e){return e.sku}),g=u.map(function(e){return{id:e.sku,google_business_vertical:"custom"}})),fbq("trackSingleCustom",I.pixelId,"VantagePurchase",{content_ids:l,content_type:"product",value:a,currency:"USD",order_id:t}),O&&(e.gtag("event","conversion",{send_to:I.googleConversionTrackerId+"/"+I.googleSendToSuffix,value:a,currency:"USD"}),e.gtag("event","purchase",{send_to:I.googleConversionTrackerId,value:a,items:g,currency:"USD"})),n&&e.vantageSnowplow("setUserId",n),e.vantageSnowplow("addTrans",t,I.storeId,r(a),r(o),r(d),s.city||null,s.state||null,s.country||null),u&&u.length>0)for(var f=0;f<u.length;f++)e.vantageSnowplow("addItem",t,u[f].sku,u[f].name,u[f].category,r(u[f].price||0),c(u[f].quantity||1));e.vantageSnowplow("trackTrans"),i(t)}function f(){if(l(q.checkout)){var e=q.checkout.line_items.map(function(e){return{product_id:e.product_id,sku:e.sku||e.product_id,name:e.title,category:null,price:e.price,quantity:e.quantity}}),t=q.checkout.order_id.toString(),n=q.checkout.total_price,a=q.checkout.total_tax,o=q.checkout.shipping_rate.price,r=q.checkout.email,c={addressLine:q.checkout.billing_address.address1,city:q.checkout.billing_address.city,state:q.checkout.billing_address.province_code,country:q.checkout.billing_address.country_code,postalCode:q.checkout.billing_address.zip};g(t,r,n,a,o,e,c)}}function p(t){fbq("trackSingleCustom",I.pixelId,"VantageViewContent",{content_ids:t,content_type:"product"}),O&&e.gtag("event","view_item",{send_to:I.googleConversionTrackerId,dynx_itemid:t})}function v(){return"undefined"!=typeof __st&&"undefined"!==__st.rid?__st.rid.toString():null}function _(){var t=v();if(t)p(t);else{var n=e.location.href+".json";$.getJSON(n).done(function(e,t){"success"==t&&p(e.product.id.toString())})}}function k(){$.getJSON("/cart.js").done(function(e,t){"success"==t&&(productIds=e.items.map(function(e){return e.id.toString()}),fbq("trackCustom","VantageAddToCart",{content_ids:productIds,content_type:"product"}))})}function m(t,n,a,o,i,d){fbq("trackSingleCustom",I.pixelId,"VantageAddToCart",{content_ids:t,content_type:"product"}),O&&e.gtag("event","add_to_cart",{send_to:I.googleConversionTrackerId,dynx_itemid:t,dynx_totalvalue:o});var u=r(o)||0,s=c(i)||1;e.vantageSnowplow("trackAddToCart",t,n,a,u,s,d)}function h(t,n,a,o,i,d){var u=r(o)||0,s=c(i)||1;e.vantageSnowplow("trackRemoveFromCart",t,n,a,u,s,d)}function y(){var e=v();e?m(e):setTimeout(k,3e3)}function w(e){e.each(function(e,t){t.addEventListener("click",y)})}function S(){return"undefined"!=typeof q}function T(){if(!S())return!1;if(e.location.href.indexOf("product")!==-1)return!0;var t=["undefined"!=typeof __st,"undefined"!=typeof __st.rtyp,"undefined"!=typeof __st.rid,"product"===__st.rtyp].every(function(e){return e});return!!t}function b(){return S()&&q.checkout}function C(){if(!b()&&S())return $("button, input").filter(function(){return this.className.match(/add[-_]?to[-_]?cart/i)+this.id.match(/add[-_]?to[-_]?cart/i)+this.name.match(/add/i)+this.value.match(/add to cart/i)})}var I=e.$vantage,q=e.Shopify,x=e.$vantageCheckout,N=e.$vantageProduct,O=I.googleConversionTrackerId&&"None"!==I.googleConversionTrackerId;if(I.initialized||(t(),fbq("track","PageView"),O&&a(),n()),localStorage["vantage-tracked-orders"]||(localStorage["vantage-tracked-orders"]=JSON.stringify([])),T()&&_(),b())f();else if(S()){var D=C();"undefined"!=typeof D&&w(D)}x&&!d(x.orderId)&&g(x.orderId||null,x.customerEmail||null,x.totalPrice||null,x.totalTax||null,x.totalShipping||null,x.lineItems||[],x.customerBillingAddress||{}),N&&p(N.productId),I.initialized=!0,I.trackViewContent=p,I.trackAddToCart=m,I.trackRemoveFromCart=h,I.trackPurchase=g,I.addTrackedOrder=i,I.wasOrderTracked=d}(window);